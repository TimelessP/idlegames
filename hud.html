<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	<title>Fighter Jet HUD</title>
	<style>
		html, body { margin:0; padding:0; width:100%; height:100%; background:black; overflow:hidden; }
		canvas { display:block; width:100%; height:100%; }
		#calibrateBtn {
			position:absolute; bottom:10px; right:10px;
			padding:8px 12px; font-size:4vw;
			background:rgba(0,0,0,0.5); color:#0f0;
			border:1px solid #0f0; border-radius:4px;
		}
	</style>
</head>
<body>
	<canvas id="hud"></canvas>
	<button id="calibrateBtn">Calibrate</button>
	<script>
		const canvas = document.getElementById('hud');
		const ctx = canvas.getContext('2d');
		function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
		window.addEventListener('resize', resize);
		resize();
    
		let heading = 0, pitch = 0, roll = 0;
		let speedKts = 0, altitudeFt = 0;
		let lastPos = null, lastTime = null;
		const offset = { alpha:0, beta:0, gamma:0 };
    
		// Device orientation for pitch, roll, heading
		if (window.DeviceOrientationEvent) {
			window.addEventListener('deviceorientation', e => {
				const alpha = e.alpha || e.webkitCompassHeading || 0;
				const beta  = e.beta || 0;
				const gamma = e.gamma || 0;
				heading = ((alpha - offset.alpha) + 360) % 360;
				pitch   = beta  - offset.beta;
				roll    = gamma - offset.gamma;
			});
		}
		document.getElementById('calibrateBtn').addEventListener('click', () => {
			// capture initial offsets
			window.addEventListener('deviceorientation', function cal(e) {
				offset.alpha = e.alpha || e.webkitCompassHeading || 0;
				offset.beta  = e.beta || 0;
				offset.gamma = e.gamma || 0;
				window.removeEventListener('deviceorientation', cal);
			});
		});
    
		// Geolocation for speed and altitude
		if (navigator.geolocation) {
			navigator.geolocation.watchPosition(pos => {
				// speed
				if (pos.coords.speed != null) {
					speedKts = pos.coords.speed / 0.51444;
				} else if (lastPos) {
					const now = pos.timestamp;
					const dLat = (pos.coords.latitude - lastPos.latitude) * Math.PI/180;
					const dLon = (pos.coords.longitude - lastPos.longitude) * Math.PI/180;
					const a = Math.sin(dLat/2)**2 + Math.cos(pos.coords.latitude*Math.PI/180)*Math.cos(lastPos.latitude*Math.PI/180)*Math.sin(dLon/2)**2;
					const d = 2 * 6371000 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
					const dt = (now - lastTime) / 1000;
					speedKts = (d/dt) / 0.51444;
				}
				lastPos = pos.coords; lastTime = pos.timestamp;
				// altitude
				if (pos.coords.altitude != null) {
					altitudeFt = pos.coords.altitude * 3.28084;
				}
			}, err => console.error(err), { enableHighAccuracy:true, maximumAge:500, timeout:5000 });
		}
    
		// Main draw loop
		function drawHUD() {
			ctx.clearRect(0,0,canvas.width,canvas.height);
			const cw = canvas.width, ch = canvas.height;
      
			// Roll & pitch (horizon)
			ctx.save();
			ctx.translate(cw/2, ch/2);
			ctx.rotate(-roll * Math.PI/180);
			const pitchOffset = (pitch/90) * (ch/2);
			ctx.strokeStyle = '#0f0'; ctx.lineWidth = 2;
			// horizon line
			ctx.beginPath();
			ctx.moveTo(-cw, pitchOffset);
			ctx.lineTo(cw, pitchOffset);
			ctx.stroke();
			// pitch ladder every 10Â°
			ctx.font = '12px monospace'; ctx.fillStyle = '#0f0';
			for (let p = 10; p <= 60; p += 10) {
				[-p, p].forEach(sign => {
					const y = pitchOffset + (sign/90)*(ch/2);
					ctx.beginPath(); ctx.moveTo(-30, y); ctx.lineTo(30, y); ctx.stroke();
					ctx.fillText(Math.abs(sign), 35, y + 4);
					ctx.fillText(Math.abs(sign), -50, y + 4);
				});
			}
			ctx.restore();
      
			// Speed tape (left)
			const tapeH = ch * 0.6, tapeW = 60, tapeX = 10, tapeY = (ch - tapeH)/2;
			ctx.fillStyle = 'rgba(0,0,0,0.5)'; ctx.fillRect(tapeX, tapeY, tapeW, tapeH);
			ctx.strokeStyle = '#0f0'; ctx.strokeRect(tapeX, tapeY, tapeW, tapeH);
			ctx.font = '14px monospace'; ctx.textAlign = 'center'; ctx.fillStyle = '#0f0';
			for (let i = -5; i <= 5; i++) {
				const spd = Math.round(speedKts/10)*10 + i*10;
				const y = ch/2 + i*20;
				ctx.fillText(spd, tapeX + tapeW/2, y + 4);
			}
			ctx.beginPath(); ctx.moveTo(tapeX + tapeW, ch/2-8); ctx.lineTo(tapeX + tapeW + 10, ch/2);
			ctx.lineTo(tapeX + tapeW, ch/2+8); ctx.fill();
      
			// Altitude tape (right)
			const atX = cw - tapeX - tapeW;
			ctx.fillStyle = 'rgba(0,0,0,0.5)'; ctx.fillRect(atX, tapeY, tapeW, tapeH);
			ctx.strokeStyle = '#0f0'; ctx.strokeRect(atX, tapeY, tapeW, tapeH);
			ctx.textAlign = 'center';
			for (let i = -5; i <= 5; i++) {
				const alt = Math.round(altitudeFt/100)*100 + i*100;
				const y = ch/2 + i*20;
				ctx.fillText(alt, atX + tapeW/2, y + 4);
			}
			ctx.beginPath(); ctx.moveTo(atX, ch/2-8); ctx.lineTo(atX - 10, ch/2);
			ctx.lineTo(atX, ch/2+8); ctx.fill();
      
			// Heading tape (bottom)
			const htW = cw * 0.8, htH = 40, htX = (cw - htW)/2, htY = ch - htH - 10;
			ctx.fillStyle = 'rgba(0,0,0,0.5)'; ctx.fillRect(htX, htY, htW, htH);
			ctx.strokeStyle = '#0f0'; ctx.strokeRect(htX, htY, htW, htH);
			ctx.textAlign = 'center'; ctx.font = '14px monospace';
			for (let i = -7; i <= 7; i++) {
				const hd = (Math.round(heading/10)*10 + i*10 + 360) % 360;
				const x = cw/2 + i*30;
				ctx.fillText(hd.toString().padStart(3,'0'), x, htY + htH/2 + 4);
				ctx.beginPath(); ctx.moveTo(x, htY);
				ctx.lineTo(x, htY + (i % 2 === 0 ? htH : htH/2)); ctx.stroke();
			}
			ctx.beginPath(); ctx.moveTo(cw/2, htY);
			ctx.lineTo(cw/2 - 10, htY - 15); ctx.lineTo(cw/2 + 10, htY - 15);
			ctx.fill();
      
			requestAnimationFrame(drawHUD);
		}
		drawHUD();
	</script>
</body>
</html>
