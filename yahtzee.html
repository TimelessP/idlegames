<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yahtzee Game</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: Arial, sans-serif;
            min-height: 100vh;
            touch-action: pan-y;
        }
        
        .game-container {
            display: flex;
            gap: 20px;
            padding: 20px;
            height: 100vh;
            box-sizing: border-box;
        }
        
        .dice-area {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
            flex: 1;
            justify-content: center;
        }
        
        .dice-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .die-canvas {
            border: none;
            background: transparent;
            cursor: pointer;
        }
        
        .game-info {
            text-align: center;
            color: white;
            font-size: 18px;
            margin-bottom: 10px;
        }
        
        .roll-button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .roll-button:hover {
            background: #45a049;
        }
        
        .roll-button:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
        
        .scorecard {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            width: 216px;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
            flex-shrink: 0;
        }
        
        .scorecard h2 {
            margin: 0 0 15px 0;
            text-align: center;
            color: #333;
            font-size: 24px;
        }
        
        .score-section {
            margin-bottom: 20px;
        }
        
        .score-section h3 {
            margin: 0 0 10px 0;
            color: #555;
            font-size: 18px;
            border-bottom: 2px solid #eee;
            padding-bottom: 5px;
        }
        
        .score-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 10px;
            border-radius: 5px;
            margin-bottom: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .score-row:hover {
            background-color: #f0f0f0;
        }
        
        .score-row.filled {
            background-color: #e8f5e8;
            cursor: default;
        }
        
        .score-row.filled:hover {
            background-color: #e8f5e8;
        }
        
        .score-label {
            font-weight: bold;
            color: #333;
            font-size: 16px;
        }
        
        .score-value {
            font-size: 16px;
            color: #666;
            min-width: 30px;
            text-align: right;
        }
        
        .score-row.filled .score-value {
            color: #333;
            font-weight: bold;
        }
        
        .total-row {
            border-top: 2px solid #333;
            margin-top: 10px;
            padding-top: 10px;
            font-weight: bold;
            font-size: 18px;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .game-container {
                gap: 10px;
                padding: 10px;
            }
            
            .scorecard {
                width: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="dice-area">
            <div class="game-info">
                <div>Roll: <span id="rollCount">1</span>/3</div>
                <div>Total Score: <span id="totalScore">0</span></div>
            </div>
            
            <div class="dice-container">
                <canvas class="die-canvas" id="die1" width="80" height="80"></canvas>
                <canvas class="die-canvas" id="die2" width="80" height="80"></canvas>
                <canvas class="die-canvas" id="die3" width="80" height="80"></canvas>
                <canvas class="die-canvas" id="die4" width="80" height="80"></canvas>
                <canvas class="die-canvas" id="die5" width="80" height="80"></canvas>
            </div>
            
            <button class="roll-button" id="rollButton">Roll Dice</button>
        </div>
        
        <div class="scorecard">
            <h2>Scorecard</h2>
            
            <div class="score-section">
                <h3>Upper Section</h3>
                <div class="score-row" data-category="ones">
                    <span class="score-label">Ones</span>
                    <span class="score-value">-</span>
                </div>
                <div class="score-row" data-category="twos">
                    <span class="score-label">Twos</span>
                    <span class="score-value">-</span>
                </div>
                <div class="score-row" data-category="threes">
                    <span class="score-label">Threes</span>
                    <span class="score-value">-</span>
                </div>
                <div class="score-row" data-category="fours">
                    <span class="score-label">Fours</span>
                    <span class="score-value">-</span>
                </div>
                <div class="score-row" data-category="fives">
                    <span class="score-label">Fives</span>
                    <span class="score-value">-</span>
                </div>
                <div class="score-row" data-category="sixes">
                    <span class="score-label">Sixes</span>
                    <span class="score-value">-</span>
                </div>
                <div class="score-row total-row" id="upperTotal">
                    <span class="score-label">Upper Total</span>
                    <span class="score-value">0</span>
                </div>
                <div class="score-row" id="bonus">
                    <span class="score-label">Bonus (63+)</span>
                    <span class="score-value">0</span>
                </div>
            </div>
            
            <div class="score-section">
                <h3>Lower Section</h3>
                <div class="score-row" data-category="threeOfAKind">
                    <span class="score-label">3 of a Kind</span>
                    <span class="score-value">-</span>
                </div>
                <div class="score-row" data-category="fourOfAKind">
                    <span class="score-label">4 of a Kind</span>
                    <span class="score-value">-</span>
                </div>
                <div class="score-row" data-category="fullHouse">
                    <span class="score-label">Full House</span>
                    <span class="score-value">-</span>
                </div>
                <div class="score-row" data-category="smallStraight">
                    <span class="score-label">Small Straight</span>
                    <span class="score-value">-</span>
                </div>
                <div class="score-row" data-category="largeStraight">
                    <span class="score-label">Large Straight</span>
                    <span class="score-value">-</span>
                </div>
                <div class="score-row" data-category="yahtzee">
                    <span class="score-label">Yahtzee</span>
                    <span class="score-value">-</span>
                </div>
                <div class="score-row" data-category="chance">
                    <span class="score-label">Chance</span>
                    <span class="score-value">-</span>
                </div>
                <div class="score-row total-row" id="lowerTotal">
                    <span class="score-label">Lower Total</span>
                    <span class="score-value">0</span>
                </div>
            </div>
            
            <div class="score-row total-row" id="grandTotal">
                <span class="score-label">GRAND TOTAL</span>
                <span class="score-value">0</span>
            </div>
        </div>
    </div>

    <script>
        // ===== GAME STATE =====
        let dice = [1, 2, 3, 4, 5]; // Current dice values
        let held = [false, false, false, false, false]; // Which dice are held
        let rollsLeft = 3;
        let currentTurn = 1;
        
        // Yahtzee scoring categories
        const CATEGORIES = {
            ones: { name: "Ones", score: null, type: "number", target: 1 },
            twos: { name: "Twos", score: null, type: "number", target: 2 },
            threes: { name: "Threes", score: null, type: "number", target: 3 },
            fours: { name: "Fours", score: null, type: "number", target: 4 },
            fives: { name: "Fives", score: null, type: "number", target: 5 },
            sixes: { name: "Sixes", score: null, type: "number", target: 6 },
            threeOfAKind: { name: "3 of a Kind", score: null, type: "special" },
            fourOfAKind: { name: "4 of a Kind", score: null, type: "special" },
            fullHouse: { name: "Full House", score: null, type: "special" },
            smallStraight: { name: "Small Straight", score: null, type: "special" },
            largeStraight: { name: "Large Straight", score: null, type: "special" },
            yahtzee: { name: "Yahtzee", score: null, type: "special" },
            chance: { name: "Chance", score: null, type: "special" }
        };

        // ===== DICE RENDERING =====
        function drawDie(canvas, value, isHeld) {
            const ctx = canvas.getContext('2d');
            const size = 80;
            
            // Clear canvas
            ctx.clearRect(0, 0, size, size);
            
            // Draw die background
            ctx.fillStyle = isHeld ? '#ffeb3b' : 'white';
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            
            const radius = 8;
            ctx.beginPath();
            ctx.roundRect(5, 5, size - 10, size - 10, radius);
            ctx.fill();
            ctx.stroke();
            
            // Draw dots
            ctx.fillStyle = 'black';
            const dotSize = 12; // Better size for visibility without touching
            const center = size / 2;
            const offset = 15;
            
            // Dot positions for each face
            const dots = {
                1: [[center, center]],
                2: [[center - offset, center - offset], [center + offset, center + offset]],
                3: [[center - offset, center - offset], [center, center], [center + offset, center + offset]],
                4: [[center - offset, center - offset], [center + offset, center - offset], 
                    [center - offset, center + offset], [center + offset, center + offset]],
                5: [[center - offset, center - offset], [center + offset, center - offset], [center, center],
                    [center - offset, center + offset], [center + offset, center + offset]],
                6: [[center - offset, center - offset], [center + offset, center - offset],
                    [center - offset, center], [center + offset, center],
                    [center - offset, center + offset], [center + offset, center + offset]]
            };
            
            if (dots[value]) {
                dots[value].forEach(([x, y]) => {
                    ctx.beginPath();
                    ctx.arc(x, y, dotSize / 2, 0, Math.PI * 2);
                    ctx.fill();
                });
            }
        }

        // ===== SCORING FUNCTIONS =====
        function calculateScore(category, diceValues) {
            const counts = [0, 0, 0, 0, 0, 0, 0]; // Index 0 unused, 1-6 for dice values
            diceValues.forEach(val => counts[val]++);
            
            switch (category) {
                case 'ones': case 'twos': case 'threes': case 'fours': case 'fives': case 'sixes':
                    const target = CATEGORIES[category].target;
                    return counts[target] * target;
                
                case 'threeOfAKind':
                    return counts.some(count => count >= 3) ? diceValues.reduce((a, b) => a + b, 0) : 0;
                
                case 'fourOfAKind':
                    return counts.some(count => count >= 4) ? diceValues.reduce((a, b) => a + b, 0) : 0;
                
                case 'fullHouse':
                    const hasThree = counts.some(count => count === 3);
                    const hasTwo = counts.some(count => count === 2);
                    return (hasThree && hasTwo) ? 25 : 0;
                
                case 'smallStraight':
                    // Must be exactly 1,2,3,4,5
                    return [1,2,3,4,5].every(num => counts[num] >= 1) ? 30 : 0;
                
                case 'largeStraight':
                    // Must be exactly 2,3,4,5,6
                    return [2,3,4,5,6].every(num => counts[num] >= 1) ? 40 : 0;
                
                case 'yahtzee':
                    return counts.some(count => count === 5) ? 50 : 0;
                
                case 'chance':
                    return diceValues.reduce((a, b) => a + b, 0);
                
                default:
                    return 0;
            }
        }

        function updateScores() {
            // Calculate potential scores for unfilled categories
            document.querySelectorAll('.score-row[data-category]').forEach(row => {
                const category = row.getAttribute('data-category');
                if (CATEGORIES[category].score === null) {
                    const potentialScore = calculateScore(category, dice);
                    row.querySelector('.score-value').textContent = potentialScore;
                    row.style.color = '#0066cc';
                }
            });
            
            // Update totals
            let upperTotal = 0;
            ['ones', 'twos', 'threes', 'fours', 'fives', 'sixes'].forEach(cat => {
                if (CATEGORIES[cat].score !== null) {
                    upperTotal += CATEGORIES[cat].score;
                }
            });
            
            let lowerTotal = 0;
            ['threeOfAKind', 'fourOfAKind', 'fullHouse', 'smallStraight', 'largeStraight', 'yahtzee', 'chance'].forEach(cat => {
                if (CATEGORIES[cat].score !== null) {
                    lowerTotal += CATEGORIES[cat].score;
                }
            });
            
            const bonus = upperTotal >= 63 ? 35 : 0;
            const grandTotal = upperTotal + bonus + lowerTotal;
            
            document.getElementById('upperTotal').querySelector('.score-value').textContent = upperTotal;
            document.getElementById('bonus').querySelector('.score-value').textContent = bonus;
            document.getElementById('lowerTotal').querySelector('.score-value').textContent = lowerTotal;
            document.getElementById('grandTotal').querySelector('.score-value').textContent = grandTotal;
            document.getElementById('totalScore').textContent = grandTotal;
        }

        // ===== GAME LOGIC =====
        function rollDice() {
            if (rollsLeft <= 0) return;
            
            for (let i = 0; i < 5; i++) {
                if (!held[i]) {
                    dice[i] = Math.floor(Math.random() * 6) + 1;
                }
            }
            
            rollsLeft--;
            updateDisplay();
            updateScores();
        }

        function toggleHold(dieIndex) {
            if (rollsLeft === 3) return; // Can't hold on first roll
            held[dieIndex] = !held[dieIndex];
            updateDisplay();
        }

        function scoreCategory(category) {
            if (CATEGORIES[category].score !== null) return; // Already scored
            if (rollsLeft === 3) return; // Must roll first
            
            const score = calculateScore(category, dice);
            CATEGORIES[category].score = score;
            
            // Update UI
            const row = document.querySelector(`[data-category="${category}"]`);
            row.classList.add('filled');
            row.querySelector('.score-value').textContent = score;
            row.style.color = '';
            
            // Reset for next turn
            rollsLeft = 3;
            held = [false, false, false, false, false];
            currentTurn++;
            
            updateDisplay();
            updateScores();
            
            // Check if game is over
            if (Object.values(CATEGORIES).every(cat => cat.score !== null)) {
                document.getElementById('rollButton').disabled = false;
                document.getElementById('rollButton').textContent = 'New Game';
                document.getElementById('rollButton').onclick = newGame;
            }
        }

        function updateDisplay() {
            // Update dice
            for (let i = 0; i < 5; i++) {
                const canvas = document.getElementById(`die${i + 1}`);
                drawDie(canvas, dice[i], held[i]);
            }
            
            // Update roll counter
            document.getElementById('rollCount').textContent = 4 - rollsLeft;
            
            // Update button
            const button = document.getElementById('rollButton');
            if (rollsLeft <= 0) {
                button.textContent = 'Choose Category';
                button.disabled = true;
            } else {
                button.textContent = `Roll Dice (${rollsLeft} left)`;
                button.disabled = false;
            }
        }

        function newGame() {
            // Reset all game state
            dice = [1, 2, 3, 4, 5];
            held = [false, false, false, false, false];
            rollsLeft = 3;
            currentTurn = 1;
            
            // Reset all categories
            Object.keys(CATEGORIES).forEach(key => {
                CATEGORIES[key].score = null;
            });
            
            // Reset UI
            document.querySelectorAll('.score-row[data-category]').forEach(row => {
                row.classList.remove('filled');
                row.querySelector('.score-value').textContent = '-';
                row.style.color = '';
            });
            
            // Reset totals
            document.getElementById('upperTotal').querySelector('.score-value').textContent = '0';
            document.getElementById('bonus').querySelector('.score-value').textContent = '0';
            document.getElementById('lowerTotal').querySelector('.score-value').textContent = '0';
            document.getElementById('grandTotal').querySelector('.score-value').textContent = '0';
            document.getElementById('totalScore').textContent = '0';
            
            // Reset button
            const button = document.getElementById('rollButton');
            button.onclick = null; // Remove the newGame onclick handler
            button.addEventListener('click', rollDice);
            
            updateDisplay();
            updateScores();
        }

        // ===== EVENT LISTENERS =====
        document.addEventListener('DOMContentLoaded', function() {
            // Dice click handlers
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`die${i}`).addEventListener('click', () => {
                    toggleHold(i - 1);
                });
            }
            
            // Roll button
            document.getElementById('rollButton').addEventListener('click', rollDice);
            
            // Score category clicks
            document.querySelectorAll('.score-row[data-category]').forEach(row => {
                row.addEventListener('click', () => {
                    const category = row.getAttribute('data-category');
                    scoreCategory(category);
                });
            });
            
            // Initial display
            updateDisplay();
            updateScores();
        });

        // ===== KEYBOARD SHORTCUTS =====
        document.addEventListener('keydown', function(e) {
            if (e.key === ' ' || e.key === 'Enter') {
                e.preventDefault();
                if (!document.getElementById('rollButton').disabled) {
                    rollDice();
                }
            }
            
            // Number keys to hold/unhold dice
            if (e.key >= '1' && e.key <= '5') {
                const dieIndex = parseInt(e.key) - 1;
                toggleHold(dieIndex);
            }
        });
    </script>
</body>
</html>
