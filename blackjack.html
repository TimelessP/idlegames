<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blackjack - Interactive Card Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0d4f3c, #1a5c3a, #0f4c3a);
            color: white;
            height: 100vh;
            height: 100dvh; /* Use dynamic viewport height for mobile */
            display: flex;
            flex-direction: column;
            overflow: hidden; /* Prevent body scrolling */
        }

        .game-header {
            background: rgba(0,0,0,0.4);
            box-shadow: 0 1px 5px rgba(0,0,0,0.3);
            padding: 8px 12px;
            position: relative;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 100%;
            gap: 15px;
        }

        .game-title {
            font-size: 1.3em;
            color: #ffd700;
            font-weight: bold;
            white-space: nowrap;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .header-stats {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 4px;
            background: rgba(255,255,255,0.1);
            border-radius: 6px;
            padding: 4px 8px;
            min-width: 0;
        }

        .stat-label {
            font-size: 0.75em;
            color: #ccc;
            white-space: nowrap;
        }

        .stat-value {
            font-size: 0.9em;
            font-weight: bold;
            color: #ffd700;
            white-space: nowrap;
        }

        .header-controls {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .header-btn {
            background: linear-gradient(145deg, #4a7c59, #5a8c69);
            border: none;
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: bold;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .header-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(0,0,0,0.3);
        }

        .header-toggle {
            display: none;
            background: none;
            border: none;
            color: #ffd700;
            font-size: 1.2em;
            cursor: pointer;
            padding: 4px;
        }

        .game-table {
            flex: 1;
            position: relative;
            background: radial-gradient(ellipse at center, #1a5c3a 0%, #0d4f3c 70%);
            border: 4px solid #8B4513;
            border-radius: 15px;
            margin: 8px;
            padding: 8px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            min-height: 0; /* Allow flex shrinking */
        }

        .zoom-container {
            position: relative;
            width: 100%;
            height: 100%;
            flex: 1;
            min-height: 300px;
            border-radius: 10px;
            overflow: hidden;
            cursor: grab;
            background: linear-gradient(45deg, 
                rgba(26, 92, 58, 0.8) 0%, 
                rgba(13, 79, 60, 0.9) 50%, 
                rgba(15, 76, 58, 0.8) 100%);
            user-select: none;
        }

        .zoom-container:active {
            cursor: grabbing;
        }

        .zoom-content {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            min-height: 100%;
            transform-origin: 0 0;
            transition: transform 0.1s ease-out;
        }

        .zoom-controls {
            position: absolute;
            top: 12px;
            right: 0px;
            z-index: 100;
            display: flex;
            gap: 4px;
        }

        .zoom-controls button {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            border: none;
            background: linear-gradient(145deg, #4a7c59, #5a8c69);
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
        }

        .zoom-controls button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.4);
        }

        .game-area {
            position: relative;
            width: 100%;
            height: 100%;
            min-width: 800px;
            min-height: 100%;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }

        .dealer-area, .player-area {
            flex: 0 0 auto;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .dealer-area {
            order: 1;
        }

        .player-area {
            order: 3;
        }

        .hand-container {
            display: flex;
            gap: 15px;
            justify-content: center;
            align-items: flex-end;
            min-height: 180px;
            padding: 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            flex-wrap: wrap;
        }

        .hand-info {
            text-align: center;
            margin-bottom: 12px;
        }

        .hand-label {
            font-size: 1.3em;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 8px;
        }

        .hand-value {
            font-size: 1.1em;
            padding: 8px 16px;
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            display: inline-block;
            min-width: 100px;
        }

        .hand-value.bust {
            color: #ff4444;
            background: rgba(255, 68, 68, 0.2);
        }

        .hand-value.blackjack {
            color: #44ff44;
            background: rgba(68, 255, 68, 0.2);
        }

        /* Card Styles */
        .card {
            border-radius: 12px;
            border: 3px solid #333;
            background: white;
            color: black;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
            text-align: center;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
            width: 120px;
            height: 168px;
            font-size: 16px;
            user-select: none;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.5);
        }

        .card.dealing {
            animation: dealCard 0.6s ease-out;
        }

        @keyframes dealCard {
            from {
                transform: translateX(-200px) rotate(-90deg);
                opacity: 0;
            }
            to {
                transform: translateX(0) rotate(0deg);
                opacity: 1;
            }
        }

        .card.flipping {
            animation: flipCard 0.8s ease-in-out;
        }

        @keyframes flipCard {
            0% { transform: rotateY(0deg); }
            50% { transform: rotateY(90deg) scale(1.1); }
            100% { transform: rotateY(0deg); }
        }

        /* Card content layout */
        .card-corner {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            font-size: 1em;
            line-height: 0.8;
            font-weight: bold;
            padding: 0.3em;
            width: 28%;
            height: 35%;
            overflow: hidden;
        }

        .card-corner.top-left {
            top: 6%;
            left: 6%;
        }

        .card-corner.bottom-right {
            bottom: 6%;
            right: 6%;
            transform: rotate(180deg);
        }

        .card-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4.5em;
            line-height: 1;
            user-select: none;
        }

        .card-value {
            font-size: 1em;
            margin: 0;
            padding: 0;
            text-align: center;
            font-weight: bold;
            line-height: 0.9;
            user-select: none;
        }

        .card-suit-small {
            font-size: 1em;
            margin: 0.05em 0 0 0;
            padding: 0;
            text-align: center;
            font-weight: bold;
            line-height: 0.9;
            user-select: none;
        }

        .red { 
            color: #c62828; 
            text-shadow: 0 0 1px rgba(0,0,0,0.3);
        }
        .black { 
            color: #1a1a1a;
            text-shadow: 0 0 1px rgba(255,255,255,0.2);
        }

        .card-back {
            background: linear-gradient(45deg, #1a1a2e, #16213e, #0f3460);
            background-size: 30px 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .card-back::before {
            content: "🂠";
            font-size: 4em;
        }

        /* Action Panel - Fixed at Bottom with Consistent Height */
        .action-panel {
            position: relative;
            width: 100%;
            background: linear-gradient(145deg, #4a7c59, #3d6b4a);
            border-top: 4px solid #66bb6a;
            border-radius: 15px 15px 0 0;
            padding: 12px 20px;
            box-shadow: 
                0 0 0 2px rgba(102, 187, 106, 0.4),
                0 -5px 20px rgba(102, 187, 106, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            margin-top: 8px;
            z-index: 50;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(145deg, #4a7c59, #5a8c69);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
            min-width: 80px;
            white-space: nowrap;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            background: #444;
            color: #888;
            cursor: not-allowed;
            transform: none;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.3);
            opacity: 0.5;
        }

        .btn:disabled:hover {
            transform: none;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.3);
        }

        .btn.primary {
            background: linear-gradient(145deg, #ffa726, #ff9800);
        }

        .btn.danger {
            background: linear-gradient(145deg, #e53935, #d32f2f);
        }

        .btn.success {
            background: linear-gradient(145deg, #43a047, #388e3c);
        }

        /* Modal Overlay System */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.2);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: modalFadeIn 0.3s ease-out;
        }

        .modal-overlay.show {
            display: flex;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-band {
            background: linear-gradient(145deg, #1a5c3a, #0d4f3c);
            border: 4px solid #8B4513;
            border-radius: 15px;
            box-shadow: 
                0 0 0 3px rgba(255, 215, 0, 0.3),
                0 10px 40px rgba(0, 0, 0, 0.8),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            padding: 25px;
            width: 90%;
            max-width: 600px;
            min-width: 300px;
            animation: modalSlideIn 0.4s ease-out;
            position: relative;
            backdrop-filter: blur(1px);
        }

        @keyframes modalSlideIn {
            from { 
                transform: translateY(-50px);
                opacity: 0;
                scale: 0.9;
            }
            to { 
                transform: translateY(0);
                opacity: 1;
                scale: 1;
            }
        }

        /* Responsive Modal Styles */
        @media (max-width: 480px) {
            .modal-band {
                width: 95%;
                min-width: 280px;
                padding: 20px 15px;
                margin: 10px;
            }
            
            .betting-controls h3 {
                font-size: 1em;
                margin-bottom: 15px;
            }
            
            .bet-buttons {
                gap: 4px;
            }
            
            .bet-btn {
                padding: 4px 8px;
                font-size: 11px;
                min-width: 35px;
            }
            
            .action-buttons {
                gap: 8px;
            }
            
            .btn {
                padding: 8px 12px;
                font-size: 12px;
                min-width: 70px;
            }
        }
        
        @media (max-width: 320px) {
            .modal-band {
                width: 98%;
                padding: 15px 10px;
            }
        }

        /* Ensure modals are above zoom controls */
        .zoom-controls {
            z-index: 100;
        }

        /* Allow interaction with zoom controls even when modal is open */
        .zoom-controls {
            position: relative;
            z-index: 1001;
        }



        /* Action Panel Content Areas - All Single Line Layouts */
        .betting-controls {
            display: flex;
            align-items: center;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .betting-controls h3 {
            margin: 0;
            font-size: 1em;
            color: #ffd700;
            white-space: nowrap;
        }

        .bet-amount {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .bet-input {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 6px;
            color: white;
            padding: 6px 8px;
            font-size: 13px;
            width: 70px;
            text-align: center;
        }

        .bet-input:focus {
            outline: none;
            border-color: #ffd700;
        }

        .bet-buttons {
            display: flex;
            gap: 4px;
            align-items: center;
        }

        .bet-btn {
            background: linear-gradient(145deg, #666, #555);
            border: none;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            transition: all 0.3s ease;
            min-width: 42px;
            min-height: 36px;
            white-space: nowrap;
        }

        .bet-btn:hover {
            background: linear-gradient(145deg, #777, #666);
        }

        /* Result Area Styles - Single Line */
        .result-area {
            display: flex;
            align-items: center;
            gap: 15px;
            justify-content: center;
        }

        .result-message {
            background: rgba(0,0,0,0.6);
            padding: 8px 16px;
            border-radius: 8px;
            border: 2px solid #ffd700;
            color: #ffd700;
            font-size: 1em;
            font-weight: bold;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
            white-space: nowrap;
        }

        .result-message.win {
            border-color: #4caf50;
            color: #4caf50;
        }

        .result-message.lose {
            border-color: #f44336;
            color: #f44336;
        }

        .result-message.tie {
            border-color: #2196f3;
            color: #2196f3;
        }

        /* Modal System - Keep for potential future use */
        .betting-modal .modal-band {
            background: linear-gradient(145deg, #2d5a3d, #1a4428);
            border: 4px solid #ffd700;
            box-shadow: 
                0 0 0 2px rgba(255, 215, 0, 0.5),
                0 0 20px rgba(255, 215, 0, 0.4),
                0 15px 40px rgba(0, 0, 0, 0.8),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        /* Responsive Design */
        
        /* Mobile Portrait (320px - 480px) */
        @media (max-width: 480px) and (orientation: portrait) {
            /* Ensure full viewport usage on mobile */
            body {
                height: 100vh;
                height: 100svh; /* Small viewport height - excludes browser UI */
                max-height: 100vh;
                max-height: 100svh;
            }
            
            .game-header {
                padding: 6px 8px;
            }
            
            .header-content {
                gap: 8px;
            }
            
            .game-title {
                font-size: 1em;
            }
            
            .header-stats {
                gap: 6px;
            }
            
            .header-stats .stat-item {
                padding: 2px 6px;
            }
            
            .stat-label {
                font-size: 0.65em;
            }
            
            .stat-value {
                font-size: 0.8em;
            }
            
            .header-toggle {
                display: block;
            }
            
            .header-controls {
                display: none;
            }
            
            /* Mobile header states */
            .header-content.show-controls .header-stats {
                display: none;
            }
            
            .header-content.show-controls .header-controls {
                display: flex;
            }
            
            .header-content.collapsed .header-stats {
                display: none;
            }
            
            .header-content.collapsed .header-controls {
                display: none;
            }
            
            .game-table {
                margin: 4px;
                padding: 4px;
            }
            
            .zoom-container {
                min-height: 250px;
            }
            
            .game-area {
                min-width: 320px;
                padding: 8px;
                gap: 8px;
            }
            
            .card {
                width: 80px;
                height: 112px;
                font-size: 12px;
            }
            
            .card-center {
                font-size: 3em;
            }
            
            .hand-container {
                gap: 8px;
                padding: 10px;
                min-height: 120px;
            }
            
            .action-panel {
                padding: 10px 12px;
                margin-top: 4px;
                min-height: 56px;
            }
            
            .action-buttons {
                gap: 6px;
            }
            
            .btn {
                padding: 6px 10px;
                font-size: 11px;
                min-width: 60px;
            }
            
            .betting-controls {
                gap: 8px;
            }
            
            .betting-controls h3 {
                font-size: 0.9em;
            }
            
            .bet-input {
                width: 60px;
                padding: 4px 6px;
                font-size: 12px;
            }
            
            .bet-btn {
                padding: 4px 8px;
                font-size: 11px;
                min-width: 32px;
                min-height: 32px;
            }
            
            .result-area {
                gap: 10px;
            }
            
            .result-message {
                padding: 6px 12px;
                font-size: 0.9em;
            }
            
            .zoom-controls button {
                width: 28px;
                height: 28px;
                font-size: 14px;
            }
            
            .betting-area {
                margin: 10px 0;
                padding: 12px;
            }
        }
        
        /* Mobile Landscape (480px - 768px) */
        @media (min-width: 481px) and (max-width: 768px) and (orientation: landscape) {
            .game-area {
                min-width: 480px;
                padding: 10px;
                gap: 10px;
            }
            
            .card {
                width: 90px;
                height: 126px;
                font-size: 13px;
            }
            
            .card-center {
                font-size: 3.5em;
            }
            
            .action-buttons {
                margin: 8px 0;
            }
            
            .betting-area {
                margin: 12px 0;
            }
        }
        
        /* Tablet Portrait (768px - 1024px) */
        @media (min-width: 769px) and (max-width: 1024px) and (orientation: portrait) {
            .card {
                width: 100px;
                height: 140px;
                font-size: 14px;
            }
            
            .card-center {
                font-size: 4em;
            }
            
            .game-area {
                min-width: 500px;
                gap: 12px;
            }
            
            .action-buttons {
                margin: 10px 0;
            }
        }
        
        /* Tablet Landscape and Small Desktop (1024px+) */
        @media (min-width: 1025px) {
            .header-toggle {
                display: none;
            }
        }
        
        /* Large screens - keep standard size */
        @media (min-width: 1200px) {
            .card {
                width: 130px;
                height: 182px;
                font-size: 17px;
            }
            
            .card-center {
                font-size: 5em;
            }
        }
        
        /* Ultra-wide screens - slightly larger */
        @media (min-width: 1600px) {
            .card {
                width: 140px;
                height: 196px;
                font-size: 18px;
            }
            
            .card-center {
                font-size: 5.5em;
            }
        }

        /* Touch Optimization */
        .btn, .header-btn, .bet-btn, .zoom-controls button {
            min-height: 44px; /* Minimum touch target size */
            -webkit-tap-highlight-color: rgba(255, 215, 0, 0.3);
        }
        
        @media (max-width: 480px) {
            .btn, .header-btn, .bet-btn, .zoom-controls button {
                min-height: 48px; /* Larger on mobile */
            }
        }
        
        /* Touch feedback */
        .btn:active, .header-btn:active, .bet-btn:active, .zoom-controls button:active {
            transform: scale(0.95);
        }
        
        /* Prevent iOS text size adjustment */
        html {
            -webkit-text-size-adjust: 100%;
        }

        /* Accessibility */
        .card[aria-label] {
            outline: 2px solid transparent;
            transition: outline 0.2s ease;
        }

        .card[aria-label]:focus {
            outline: 3px solid #ffd700;
            outline-offset: 2px;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0,0,0,0);
            white-space: nowrap;
            border: 0;
        }

        /* Prevent unwanted interactions during dragging */
        .zoom-container *,
        .game-area *,
        .card * {
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
        }

        .zoom-container.dragging .game-area,
        .zoom-container.dragging .game-area * {
            pointer-events: none;
        }

        .zoom-container.dragging .zoom-controls,
        .zoom-container.dragging .zoom-controls *,
        .zoom-container.dragging .action-buttons,
        .zoom-container.dragging .action-buttons * {
            pointer-events: auto;
        }
    </style>
</head>
<body>
    <header class="game-header">
        <div class="header-content">
            <div class="game-title">♠️ Blackjack ♥️</div>
            <div class="header-stats">
                <div class="stat-item">
                    <span class="stat-label">Chips:</span>
                    <span class="stat-value" id="chip-count">$1000</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Bet:</span>
                    <span class="stat-value" id="current-bet">$0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">W:</span>
                    <span class="stat-value" id="win-count">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">G:</span>
                    <span class="stat-value" id="game-count">0</span>
                </div>
            </div>
            <div class="header-controls">
                <button class="header-btn" onclick="newGame()">New Game</button>
                <button class="header-btn" onclick="resetStats()">Reset</button>
            </div>
            <button class="header-toggle" onclick="toggleHeader()">⋯</button>
        </div>
    </header>

    <main class="game-table">
        <div id="zoom-demo" class="zoom-container">
            <div class="zoom-controls">
                <button onclick="zoomIn()" title="Zoom In" aria-label="Zoom In">+</button>
                <button onclick="zoomOut()" title="Zoom Out" aria-label="Zoom Out">−</button>
                <button onclick="resetZoom()" title="Reset View" aria-label="Reset View">⌂</button>
            </div>

            <div id="zoom-content" class="zoom-content">
                <div class="game-area">
                    <!-- Dealer Area -->
                    <div class="dealer-area">
                        <div class="hand-info">
                            <div class="hand-label">Dealer</div>
                            <div class="hand-value" id="dealer-value">0</div>
                        </div>
                        <div class="hand-container" id="dealer-hand"></div>
                    </div>

                    <!-- Player Area -->
                    <div class="player-area">
                        <div class="hand-info">
                            <div class="hand-label">Player</div>
                            <div class="hand-value" id="player-value">0</div>
                        </div>
                        <div class="hand-container" id="player-hand"></div>
                    </div>


                </div>
            </div>
        </div>

        <!-- Dynamic Action Panel at Bottom -->
        <div class="action-panel" id="action-panel">
            <!-- Betting Controls -->
            <div class="betting-controls" id="betting-controls">
                <div class="bet-amount">
                    <label for="bet-input-panel">$</label>
                    <input type="number" id="bet-input-panel" class="bet-input" 
                           min="1" max="1000" value="25" 
                           aria-label="Bet amount">
                </div>
                <div class="bet-buttons">
                    <button class="bet-btn" onclick="adjustBetPanel(-10)">-$10</button>
                    <button class="bet-btn" onclick="adjustBetPanel(10)">+$10</button>
                    <button class="bet-btn" onclick="adjustBetPanel(-100)">-$100</button>
                    <button class="bet-btn" onclick="adjustBetPanel(100)">+$100</button>
                </div>
                <button class="btn success" onclick="placeBetPanel()" id="place-bet-panel-btn">
                    Bet
                </button>
            </div>

            <!-- Game Action Buttons -->
            <div class="action-buttons" id="action-buttons" style="display: none;">
                <button class="btn primary" onclick="hit()" id="hit-btn">Hit</button>
                <button class="btn" onclick="stand()" id="stand-btn">Stand</button>
                <button class="btn" onclick="doubleDown()" id="double-btn">Double Down</button>
            </div>

            <!-- Game Result Area -->
            <div class="result-area" id="result-area" style="display: none;">
                <div class="result-message" id="result-message"></div>
                <button class="btn primary" onclick="newGame()" id="next-hand-btn">Next Hand</button>
            </div>
        </div>

        <!-- Betting Modal Overlay -->
        <div class="modal-overlay betting-modal" id="betting-modal">
            <div class="modal-band">
                <div class="betting-controls">
                    <h3>Place Your Bet</h3>
                    <div class="bet-amount">
                        <label for="bet-input">$</label>
                        <input type="number" id="bet-input" class="bet-input" 
                               min="1" max="1000" value="25" 
                               aria-label="Bet amount">
                    </div>
                    <div class="bet-buttons">
                        <button class="bet-btn" onclick="setBet(5)">$5</button>
                        <button class="bet-btn" onclick="setBet(25)">$25</button>
                        <button class="bet-btn" onclick="setBet(50)">$50</button>
                        <button class="bet-btn" onclick="setBet(100)">$100</button>
                    </div>
                    <button class="btn success" onclick="placeBet()" id="place-bet-btn">
                        Place Bet & Deal
                    </button>
                </div>
            </div>
        </div>

        </div>
    </main>

    <script>
        // Card data structure
        const suits = ['♠', '♥', '♦', '♣'];
        const values = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
        const suitNames = ['spades', 'hearts', 'diamonds', 'clubs'];

        // Card class
        class Card {
            constructor(suit, value, suitIndex) {
                this.suit = suit;
                this.value = value;
                this.suitIndex = suitIndex;
                this.isRed = suit === '♥' || suit === '♦';
                this.isFlipped = false;
                this.id = `${suitNames[suitIndex]}-${value}`;
            }

            getBlackjackValue() {
                if (this.value === 'A') return 11;
                if (['J', 'Q', 'K'].includes(this.value)) return 10;
                return parseInt(this.value);
            }

            toString() {
                return `${this.value}${this.suit}`;
            }
        }

        // Game state
        let deck = [];
        let playerHand = [];
        let dealerHand = [];
        let gameState = 'betting'; // betting, playing, dealer-turn, game-over
        let playerChips = 1000;
        let currentBet = 0;
        let gamesPlayed = 0;
        let gamesWon = 0;

        // Zoom and pan functionality
        let currentZoom = 1;
        let panX = 0;
        let panY = 0;
        let isDragging = false;
        let lastMouseX = 0;
        let lastMouseY = 0;

        // Initialize game
        function initGame() {
            setupZoomPan();
            setupModalHandlers();
            updateUI();
            newGame();
        }

        // Modal management functions
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.add('show');
            // Prevent body scrolling when modal is open
            document.body.style.overflow = 'hidden';
        }

        function hideModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('show');
            // Restore body scrolling
            document.body.style.overflow = '';
        }

        function hideAllModals() {
            hideModal('betting-modal');
            hideActionPanel();
        }

        // Action panel state management
        function showBettingPanel() {
            document.getElementById('betting-controls').style.display = 'flex';
            document.getElementById('action-buttons').style.display = 'none';
            document.getElementById('result-area').style.display = 'none';
        }

        function showActionPanel() {
            document.getElementById('betting-controls').style.display = 'none';
            document.getElementById('action-buttons').style.display = 'flex';
            document.getElementById('result-area').style.display = 'none';
            
            // Re-enable action buttons for new hand
            document.getElementById('hit-btn').disabled = false;
            document.getElementById('stand-btn').disabled = false;
            // Double down will be handled by updateUI based on game state
            
            updateUI(); // Update button states
        }

        function showResultPanel(message, messageType) {
            document.getElementById('betting-controls').style.display = 'none';
            document.getElementById('action-buttons').style.display = 'none';
            document.getElementById('result-area').style.display = 'flex';
            
            const resultMessage = document.getElementById('result-message');
            resultMessage.textContent = message;
            resultMessage.className = `result-message ${messageType}`;
        }

        function hideActionPanel() {
            // Keep panels visible but disable buttons for legacy compatibility
            document.getElementById('hit-btn').disabled = true;
            document.getElementById('stand-btn').disabled = true;
            document.getElementById('double-btn').disabled = true;
        }

        // Setup modal event handlers
        function setupModalHandlers() {
            // Close modals when clicking outside the band
            document.getElementById('betting-modal').addEventListener('click', (e) => {
                if (e.target === e.currentTarget) {
                    // Don't allow closing betting modal by clicking outside
                    // Player must place a bet or start a new game
                }
            });

            // Handle escape key to close modals
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    // Only allow closing if not in critical game state
                    if (gameState === 'betting') {
                        // Can't close betting modal, must place bet
                    }
                }
            });
        }

        // Create a shuffled deck
        function createDeck() {
            const newDeck = [];
            suits.forEach((suit, suitIndex) => {
                values.forEach(value => {
                    newDeck.push(new Card(suit, value, suitIndex));
                });
            });
            return shuffle(newDeck);
        }

        // Shuffle array (Fisher-Yates algorithm)
        function shuffle(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // Create card element
        function createCardElement(card, showBack = false, dealAnimation = true) {
            const cardEl = document.createElement('div');
            cardEl.className = `card ${card.isRed ? 'red' : 'black'}`;
            cardEl.dataset.cardId = card.id;
            
            // Add accessibility attributes
            cardEl.setAttribute('role', 'img');
            cardEl.setAttribute('tabindex', '0');
            
            if (showBack) {
                cardEl.className += ' card-back';
                cardEl.innerHTML = '';
                cardEl.setAttribute('aria-label', 'Hidden card');
            } else {
                cardEl.innerHTML = `
                    <div class="card-corner top-left">
                        <div class="card-value">${card.value}</div>
                        <div class="card-suit-small">${card.suit}</div>
                    </div>
                    <div class="card-center">${card.suit}</div>
                    <div class="card-corner bottom-right">
                        <div class="card-value">${card.value}</div>
                        <div class="card-suit-small">${card.suit}</div>
                    </div>
                `;
                cardEl.setAttribute('aria-label', `${card.value} of ${getSuitName(card.suit)}`);
            }

            if (dealAnimation) {
                cardEl.classList.add('dealing');
            }

            // Prevent dragging
            cardEl.addEventListener('dragstart', (e) => e.preventDefault());
            cardEl.addEventListener('contextmenu', (e) => e.preventDefault());
            cardEl.setAttribute('draggable', 'false');
            
            return cardEl;
        }

        // Helper function to get suit name for accessibility
        function getSuitName(suit) {
            const suitNames = {
                '♠': 'Spades',
                '♥': 'Hearts', 
                '♦': 'Diamonds',
                '♣': 'Clubs'
            };
            return suitNames[suit] || suit;
        }

        // Calculate hand value
        function calculateHandValue(hand) {
            let value = 0;
            let aces = 0;

            hand.forEach(card => {
                const cardValue = card.getBlackjackValue();
                value += cardValue;
                if (card.value === 'A') aces++;
            });

            // Adjust for aces
            while (value > 21 && aces > 0) {
                value -= 10;
                aces--;
            }

            return value;
        }

        // Deal a card
        function dealCard(toPlayer = true) {
            if (deck.length < 10) {
                deck = createDeck(); // Reshuffle if deck is low
            }

            const card = deck.pop();
            if (toPlayer) {
                playerHand.push(card);
                addCardToHand('player-hand', card);
            } else {
                dealerHand.push(card);
                const showBack = dealerHand.length === 2 && gameState === 'playing';
                addCardToHand('dealer-hand', card, showBack);
            }

            updateHandValues();
            return card;
        }

        // Add card to hand display
        function addCardToHand(handId, card, showBack = false) {
            const handContainer = document.getElementById(handId);
            const cardEl = createCardElement(card, showBack);
            
            // Add with delay for animation
            setTimeout(() => {
                handContainer.appendChild(cardEl);
            }, handContainer.children.length * 300);
        }

        // Update hand value displays
        function updateHandValues() {
            const playerValue = calculateHandValue(playerHand);
            const dealerValue = calculateHandValue(dealerHand);

            const playerValueEl = document.getElementById('player-value');
            const dealerValueEl = document.getElementById('dealer-value');

            playerValueEl.textContent = playerValue;
            playerValueEl.className = 'hand-value';
            
            if (playerValue === 21 && playerHand.length === 2) {
                playerValueEl.className += ' blackjack';
                playerValueEl.textContent = '21 (Blackjack!)';
            } else if (playerValue > 21) {
                playerValueEl.className += ' bust';
                playerValueEl.textContent = `${playerValue} (Bust!)`;
            }

            // Only show dealer's full value during dealer turn or game over
            if (gameState === 'dealer-turn' || gameState === 'game-over') {
                dealerValueEl.textContent = dealerValue;
                if (dealerValue === 21 && dealerHand.length === 2) {
                    dealerValueEl.className = 'hand-value blackjack';
                    dealerValueEl.textContent = '21 (Blackjack!)';
                } else if (dealerValue > 21) {
                    dealerValueEl.className = 'hand-value bust';
                    dealerValueEl.textContent = `${dealerValue} (Bust!)`;
                } else {
                    dealerValueEl.className = 'hand-value';
                }
            } else {
                // Only show first card value during play
                if (dealerHand.length > 0) {
                    const firstCardValue = dealerHand[0].getBlackjackValue();
                    dealerValueEl.textContent = `${firstCardValue} + ?`;
                    dealerValueEl.className = 'hand-value';
                }
            }
        }

        // Player actions
        function hit() {
            // Hide actions immediately for instant feedback
            hideActionPanel();
            
            dealCard(true);
            const playerValue = calculateHandValue(playerHand);
            
            // Update UI to disable double down after hitting (no longer 2 cards)
            updateUI();
            
            if (playerValue >= 21) {
                if (playerValue > 21) {
                    endGame('bust');
                } else {
                    gameState = 'dealer-turn';
                    // Reveal dealer's hidden card
                    revealDealerCard();
                    // Dealer plays
                    setTimeout(() => {
                        dealerPlay();
                    }, 1000);
                }
            } else {
                // Re-enable actions if game continues
                showActionPanel();
            }
        }

        function stand() {
            // Hide actions immediately for instant feedback
            hideActionPanel();
            
            gameState = 'dealer-turn';
            
            // Reveal dealer's hidden card
            revealDealerCard();
            
            // Dealer plays
            setTimeout(() => {
                dealerPlay();
            }, 1000);
        }

        function doubleDown() {
            if (playerChips < currentBet) {
                showMessage('Not enough chips to double down!', 'lose');
                return;
            }
            
            // Hide actions immediately for instant feedback
            hideActionPanel();
            
            playerChips -= currentBet;
            currentBet *= 2;
            updateUI();
            
            dealCard(true);
            const playerValue = calculateHandValue(playerHand);
            
            if (playerValue > 21) {
                endGame('bust');
            } else {
                stand();
            }
        }

        // Reveal dealer's hidden card
        function revealDealerCard() {
            const dealerHandEl = document.getElementById('dealer-hand');
            const hiddenCard = dealerHandEl.children[1];
            
            if (hiddenCard && hiddenCard.classList.contains('card-back')) {
                const card = dealerHand[1];
                hiddenCard.classList.add('flipping');
                
                setTimeout(() => {
                    hiddenCard.className = `card ${card.isRed ? 'red' : 'black'}`;
                    hiddenCard.innerHTML = `
                        <div class="card-corner top-left">
                            <div class="card-value">${card.value}</div>
                            <div class="card-suit-small">${card.suit}</div>
                        </div>
                        <div class="card-center">${card.suit}</div>
                        <div class="card-corner bottom-right">
                            <div class="card-value">${card.value}</div>
                            <div class="card-suit-small">${card.suit}</div>
                        </div>
                    `;
                    hiddenCard.setAttribute('aria-label', `${card.value} of ${getSuitName(card.suit)}`);
                    updateHandValues();
                }, 400);
            }
        }

        // Dealer plays
        function dealerPlay() {
            const dealerValue = calculateHandValue(dealerHand);
            
            if (dealerValue < 17) {
                dealCard(false);
                setTimeout(() => {
                    dealerPlay();
                }, 800);
            } else {
                endGame('compare');
            }
        }

        // End game and determine winner
        function endGame(reason) {
            gameState = 'game-over';
            gamesPlayed++;
            
            // Hide any open modals
            hideAllModals();
            
            const playerValue = calculateHandValue(playerHand);
            const dealerValue = calculateHandValue(dealerHand);
            
            let message = '';
            let messageClass = '';
            let winAmount = 0;

            if (reason === 'bust') {
                message = 'You bust! Dealer wins.';
                messageClass = 'lose';
            } else if (reason === 'compare') {
                const playerBlackjack = playerValue === 21 && playerHand.length === 2;
                const dealerBlackjack = dealerValue === 21 && dealerHand.length === 2;
                
                if (dealerValue > 21) {
                    message = 'Dealer busts! You win!';
                    messageClass = 'win';
                    winAmount = currentBet * 2;
                    gamesWon++;
                } else if (playerBlackjack && !dealerBlackjack) {
                    message = 'Blackjack! You win!';
                    messageClass = 'win';
                    winAmount = currentBet * 2.5;
                    gamesWon++;
                } else if (dealerBlackjack && !playerBlackjack) {
                    message = 'Dealer has Blackjack! You lose.';
                    messageClass = 'lose';
                } else if (playerValue > dealerValue) {
                    message = 'You win!';
                    messageClass = 'win';
                    winAmount = currentBet * 2;
                    gamesWon++;
                } else if (dealerValue > playerValue) {
                    message = 'Dealer wins!';
                    messageClass = 'lose';
                } else {
                    message = 'Push! It\'s a tie.';
                    messageClass = 'tie';
                    winAmount = currentBet; // Return bet
                }
            }

            playerChips += winAmount;
            showMessage(message, messageClass);
            updateUI();
        }

        // Show game message in action panel
        function showMessage(text, type) {
            showResultPanel(text, type);
        }

        // Hide game message
        function hideMessage() {
            // Messages are now part of the action panel state
        }

        // Betting functions - Modal version (kept for compatibility)
        function setBet(amount) {
            document.getElementById('bet-input').value = amount;
        }

        function placeBet() {
            const betInput = document.getElementById('bet-input');
            const betAmount = parseInt(betInput.value);
            
            if (!betAmount || betAmount < 1) {
                alert('Please enter a valid bet amount');
                return;
            }
            
            if (betAmount > playerChips) {
                alert('Not enough chips!');
                return;
            }
            
            currentBet = betAmount;
            playerChips -= betAmount;
            
            startNewHand();
        }

        // Betting functions - Panel version
        function setBetPanel(amount) {
            document.getElementById('bet-input-panel').value = amount;
        }

        function adjustBetPanel(change) {
            const betInput = document.getElementById('bet-input-panel');
            const currentBet = parseInt(betInput.value) || 0;
            const newBet = Math.max(1, Math.min(playerChips, currentBet + change));
            betInput.value = newBet;
        }

        function placeBetPanel() {
            const betInput = document.getElementById('bet-input-panel');
            const betAmount = parseInt(betInput.value);
            
            if (!betAmount || betAmount < 1) {
                alert('Please enter a valid bet amount');
                return;
            }
            
            if (betAmount > playerChips) {
                alert('Not enough chips!');
                return;
            }
            
            // Hide betting controls immediately for instant feedback
            document.getElementById('betting-controls').style.display = 'none';
            
            currentBet = betAmount;
            playerChips -= betAmount;
            
            startNewHand();
        }

        // Start new hand
        function startNewHand() {
            gameState = 'playing';
            playerHand = [];
            dealerHand = [];
            
            // Clear hands
            document.getElementById('player-hand').innerHTML = '';
            document.getElementById('dealer-hand').innerHTML = '';
            
            // Deal initial cards
            dealCard(true);  // Player first card
            dealCard(false); // Dealer first card
            dealCard(true);  // Player second card
            dealCard(false); // Dealer second card (hidden)
            
            // Check for blackjack
            setTimeout(() => {
                const playerValue = calculateHandValue(playerHand);
                const dealerValue = calculateHandValue(dealerHand);
                
                if (playerValue === 21 || dealerValue === 21) {
                    revealDealerCard();
                    setTimeout(() => {
                        endGame('compare');
                    }, 1000);
                } else {
                    showActionPanel();
                }
            }, 1500);
            
            updateUI();
        }

        // New game
        function newGame() {
            // Hide current result area immediately for instant feedback
            if (document.getElementById('result-area').style.display === 'flex') {
                document.getElementById('result-area').style.display = 'none';
            }
            
            // Clear the table immediately - remove all cards
            document.getElementById('player-hand').innerHTML = '';
            document.getElementById('dealer-hand').innerHTML = '';
            
            // Clear hand values/counts
            const playerValueEl = document.getElementById('player-value');
            const dealerValueEl = document.getElementById('dealer-value');
            if (playerValueEl) playerValueEl.textContent = '0';
            if (dealerValueEl) dealerValueEl.textContent = '0';
            
            // Reset game state
            playerHand = [];
            dealerHand = [];
            
            if (playerChips <= 0) {
                playerChips = 1000; // Reset chips if broke
            }
            
            gameState = 'betting';
            currentBet = 0;
            
            // Show betting panel in action area
            showBettingPanel();
            
            // Create new deck if needed
            if (deck.length === 0) {
                deck = createDeck();
            }
            
            updateUI();
        }

        // Reset statistics
        function resetStats() {
            if (confirm('Reset all statistics?')) {
                playerChips = 1000;
                gamesPlayed = 0;
                gamesWon = 0;
                updateUI();
                newGame();
            }
        }

        // Update UI elements
        function updateUI() {
            document.getElementById('chip-count').textContent = `$${playerChips}`;
            document.getElementById('current-bet').textContent = `$${currentBet}`;
            document.getElementById('game-count').textContent = gamesPlayed;
            document.getElementById('win-count').textContent = gamesWon;
            
            // Update bet input max for both modal and panel versions
            const betInputModal = document.getElementById('bet-input');
            const betInputPanel = document.getElementById('bet-input-panel');
            if (betInputModal) betInputModal.max = playerChips;
            if (betInputPanel) betInputPanel.max = playerChips;
            
            // Handle double down button state
            const doubleBtn = document.getElementById('double-btn');
            if (doubleBtn) {
                // Enable double down only if: we're in playing state, have enough chips, and have exactly 2 cards
                const canDoubleDown = gameState === 'playing' && 
                                    playerChips >= currentBet && 
                                    playerHand.length === 2 &&
                                    !document.getElementById('hit-btn').disabled;
                doubleBtn.disabled = !canDoubleDown;
            }
        }

        // Zoom and pan functionality
        function setupZoomPan() {
            const zoomContainer = document.getElementById('zoom-demo');
            const zoomContent = document.getElementById('zoom-content');
            
            // Mouse wheel zoom
            zoomContainer.addEventListener('wheel', (e) => {
                e.preventDefault();
                const rect = zoomContainer.getBoundingClientRect();
                const mouseX = e.clientX - rect.left;
                const mouseY = e.clientY - rect.top;
                
                const zoomFactor = e.deltaY > 0 ? 0.9 : 1.1;
                zoomTowardsPoint(zoomFactor, mouseX, mouseY);
            });
            
            // Mouse drag pan
            zoomContainer.addEventListener('mousedown', (e) => {
                // Don't start dragging if clicking on zoom controls
                if (e.target.closest('.zoom-controls') || 
                    e.target.closest('.action-buttons') || 
                    e.target.closest('.betting-area') ||
                    e.target.closest('.btn')) {
                    return;
                }
                
                e.preventDefault(); // Prevent text selection
                isDragging = true;
                lastMouseX = e.clientX;
                lastMouseY = e.clientY;
                zoomContainer.style.cursor = 'grabbing';
                zoomContainer.classList.add('dragging');
            });
            
            document.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                e.preventDefault(); // Prevent text selection during drag
                
                const deltaX = e.clientX - lastMouseX;
                const deltaY = e.clientY - lastMouseY;
                
                panX += deltaX;
                panY += deltaY;
                
                lastMouseX = e.clientX;
                lastMouseY = e.clientY;
                
                updateTransform();
            });
            
            document.addEventListener('mouseup', () => {
                isDragging = false;
                zoomContainer.style.cursor = 'grab';
                zoomContainer.classList.remove('dragging');
            });
            
            // Prevent context menu on right click
            zoomContainer.addEventListener('contextmenu', (e) => {
                e.preventDefault();
            });
            
            // Touch support for mobile
            let lastTouchDistance = 0;
            let touchStartTime = 0;
            
            zoomContainer.addEventListener('touchstart', (e) => {
                touchStartTime = Date.now();
                
                // Don't start gestures if touching UI elements
                if (e.target.closest('.zoom-controls') || 
                    e.target.closest('.action-buttons') || 
                    e.target.closest('.betting-area') ||
                    e.target.closest('.btn')) {
                    return;
                }
                
                if (e.touches.length === 2 && e.cancelable) {
                    e.preventDefault();
                    lastTouchDistance = getTouchDistance(e.touches);
                } else if (e.touches.length === 1) {
                    isDragging = true;
                    lastMouseX = e.touches[0].clientX;
                    lastMouseY = e.touches[0].clientY;
                }
            });
            
            zoomContainer.addEventListener('touchmove', (e) => {
                if (e.touches.length === 2 && e.cancelable) {
                    e.preventDefault();
                    const currentDistance = getTouchDistance(e.touches);
                    const zoomFactor = currentDistance / lastTouchDistance;
                    
                    // Get center point between fingers for zoom target
                    const centerX = (e.touches[0].clientX + e.touches[1].clientX) / 2;
                    const centerY = (e.touches[0].clientY + e.touches[1].clientY) / 2;
                    const rect = zoomContainer.getBoundingClientRect();
                    const targetX = centerX - rect.left;
                    const targetY = centerY - rect.top;
                    
                    zoomTowardsPoint(zoomFactor, targetX, targetY);
                    lastTouchDistance = currentDistance;
                } else if (e.touches.length === 1 && isDragging && e.cancelable) {
                    // Only pan if we've moved enough (prevents accidental panning)
                    const deltaX = e.touches[0].clientX - lastMouseX;
                    const deltaY = e.touches[0].clientY - lastMouseY;
                    
                    if (Math.abs(deltaX) > 3 || Math.abs(deltaY) > 3) {
                        e.preventDefault();
                        panX += deltaX;
                        panY += deltaY;
                        updateTransform();
                    }
                    
                    lastMouseX = e.touches[0].clientX;
                    lastMouseY = e.touches[0].clientY;
                }
            });
            
            zoomContainer.addEventListener('touchend', (e) => {
                const touchDuration = Date.now() - touchStartTime;
                
                // Quick tap to reset zoom if zoomed in
                if (touchDuration < 300 && currentZoom > 1.1 && e.touches.length === 0) {
                    resetZoom();
                }
                
                isDragging = false;
            });
        }
        
        function getTouchDistance(touches) {
            const dx = touches[0].clientX - touches[1].clientX;
            const dy = touches[0].clientY - touches[1].clientY;
            return Math.sqrt(dx * dx + dy * dy);
        }
        
        function updateTransform() {
            const zoomContent = document.getElementById('zoom-content');
            zoomContent.style.transform = `translate(${panX}px, ${panY}px) scale(${currentZoom})`;
        }
        
        function zoomIn() {
            zoomTowardsPoint(1.2, null, null); // No specific point, zoom to center
        }
        
        function zoomOut() {
            zoomTowardsPoint(1 / 1.2, null, null); // No specific point, zoom to center
        }
        
        // Generic zoom function that can zoom towards a specific point or center
        function zoomTowardsPoint(zoomFactor, targetX = null, targetY = null) {
            const newZoom = Math.max(0.1, Math.min(5, currentZoom * zoomFactor));
            
            if (targetX !== null && targetY !== null) {
                // Zoom towards specific point (mouse position)
                const zoomChange = newZoom / currentZoom;
                panX = targetX - (targetX - panX) * zoomChange;
                panY = targetY - (targetY - panY) * zoomChange;
            } else {
                // Zoom towards center of viewport
                const rect = document.getElementById('zoom-demo').getBoundingClientRect();
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                
                const zoomChange = newZoom / currentZoom;
                panX = centerX - (centerX - panX) * zoomChange;
                panY = centerY - (centerY - panY) * zoomChange;
            }
            
            currentZoom = newZoom;
            updateTransform();
        }
        
        function resetZoom() {
            currentZoom = 1;
            panX = 0;
            panY = 0;
            updateTransform();
        }

        // Header toggle for mobile - cycles through: stats → controls → hidden → repeat
        function toggleHeader() {
            const headerContent = document.querySelector('.header-content');
            
            if (headerContent.classList.contains('collapsed')) {
                // Currently hidden → show stats (default state)
                headerContent.classList.remove('collapsed');
                headerContent.classList.remove('show-controls');
            } else if (headerContent.classList.contains('show-controls')) {
                // Currently showing controls → hide everything
                headerContent.classList.add('collapsed');
                headerContent.classList.remove('show-controls');
            } else {
                // Currently showing stats → show controls
                headerContent.classList.add('show-controls');
            }
        }

        // Initialize game when page loads
        window.addEventListener('load', () => {
            initGame();
        });
    </script>
</body>
</html>