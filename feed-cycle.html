<!DOCTYPE html>
<html lang="en" data-theme="system">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Feed Cycle — Delightful RSS/Atom Reader</title>
  <link rel="icon" href="favicon.ico" />
  <link rel="stylesheet" href="feed-cycle.css" />
  <meta name="color-scheme" content="light dark" />
  <meta name="description" content="Feed Cycle — a delightful, local-first RSS/Atom reader with OPML, media, search, favorites, tags, and themes." />
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to content</a>
  <header class="app-header" role="banner">
    <div class="brand">
      <button id="btn-toggle-sidebar" class="only-mobile" aria-label="Open menu" aria-controls="sidebar" aria-expanded="false" title="Menu">☰ <span class="btn-text">Menu</span></button>
      <span class="logo">🌀</span>
      <h1>Feed Cycle</h1>
    </div>
    <div class="actions">
  <button id="btn-refresh" title="Refresh All Feeds (r). Hold Shift to force.">⟳ <span class="btn-text">Refresh</span></button>
  <button id="btn-import" title="Import OPML">⬆ <span class="btn-text">Import</span></button>
  <button id="btn-export" title="Export OPML">⬇ <span class="btn-text">Export</span></button>
  <button id="btn-edit-opml" title="Edit OPML">✏️ <span class="btn-text">Edit</span></button>
  <button id="btn-settings" title="Settings">⚙️ <span class="btn-text">Settings</span></button>
      <div class="theme-toggle" title="Theme">
        <button id="btn-theme-toggle" aria-label="Toggle theme" title="Theme">🌓</button>
        <select id="theme-select" aria-label="Theme">
          <option value="system">System</option>
          <option value="light">Light</option>
          <option value="dark">Dark</option>
        </select>
      </div>
    </div>
  </header>

  <div id="sidebar-backdrop" class="sidebar-backdrop" hidden></div>

  <div class="toolbar" role="search">
    <div class="search-box">
      <input id="search-input" type="text" placeholder="Search posts…" aria-label="Search posts" />
  <button id="btn-clear" title="Clear" aria-label="Clear search">✖</button>
  <button id="btn-search" title="Search (Enter)">🔎 <span class="btn-text">Search</span></button>
    </div>
    <div class="filters">
      <select id="filter-subscription" aria-label="Filter by subscription">
        <option value="">All Subscriptions</option>
      </select>
      <select id="filter-category" aria-label="Filter by category">
        <option value="">All Categories</option>
      </select>
      <select id="filter-tag" aria-label="Filter by tag">
        <option value="">All Tags</option>
      </select>
      <label class="checkbox"><input id="filter-unread" type="checkbox" /> Unread</label>
      <label class="checkbox"><input id="filter-favorites" type="checkbox" /> Favorites</label>
    </div>
  </div>

  <main class="app-main" role="main">
  <aside id="sidebar" class="sidebar" aria-label="Subscriptions">
      <div class="sidebar-header">
        <h2>Subscriptions</h2>
  <button id="btn-add-feed" title="Add Subscription">＋ <span class="btn-text">Add</span></button>
      </div>
      <ul id="feed-list" class="feed-list" role="tree"></ul>
      <div class="sidebar-header">
        <h3 style="margin:0">Categories</h3>
  <button id="btn-add-category" title="Add Category">＋ <span class="btn-text">Add</span></button>
      </div>
      <ul id="category-list" class="category-list" role="list"></ul>
      <div class="sidebar-header">
        <h3 style="margin:0">Tags</h3>
      </div>
      <ul id="tag-list" class="category-list" role="list"></ul>
    </aside>

  <section class="content" id="main-content" tabindex="-1">
      <div id="empty-state" class="empty-state" hidden>
        <p>Welcome to Feed Cycle! Import an OPML file or add a subscription to get started.</p>
        <p>
          <button id="get-sample-opml">Load Sample OPML</button>
        </p>
      </div>
      <div id="post-grid" class="post-grid" aria-live="polite" aria-busy="false"></div>
    </section>
  </main>

  <footer class="app-footer" role="contentinfo">
    <span id="status-text" role="status" aria-live="polite" aria-atomic="true">Ready.</span>
  </footer>

  <!-- Hidden inputs -->
  <input id="opml-file-input" type="file" accept=".opml, text/xml, application/xml" hidden />

  <!-- Modals -->
  <dialog id="modal-settings" class="modal">
    <form method="dialog" class="modal-body">
      <h3>Settings</h3>
      <label>
        Default refresh (minutes)
        <input id="setting-refresh-min" type="number" min="5" step="5" />
      </label>
      <label>
        Cache max age (minutes)
        <input id="setting-cache-maxage" type="number" min="15" step="15" />
      </label>
      <label>
        CORS proxy (optional)
        <input id="setting-cors-proxy" type="url" placeholder="e.g. https://api.allorigins.win/raw?url=" />
        <small>Leave blank to auto-try public proxies. You can override with a custom pattern (supports %s or ?url= style). Used to bypass CORS when fetching feeds anywhere.</small>
      </label>
      <menu class="modal-actions">
  <button value="cancel">✖ <span class="btn-text">Cancel</span></button>
  <button id="btn-clear-data" type="button" title="Clear all saved data (LocalStorage)">🧹 <span class="btn-text">Clear</span></button>
  <button id="btn-save-settings" value="default">💾 <span class="btn-text">Save</span></button>
      </menu>
    </form>
  </dialog>

  <dialog id="modal-opml" class="modal wide">
    <form method="dialog" class="modal-body">
      <h3>Edit OPML</h3>
      <textarea id="opml-editor" spellcheck="false"></textarea>
      <menu class="modal-actions">
  <button value="cancel">✖ <span class="btn-text">Cancel</span></button>
  <button id="btn-save-opml" value="default">💾 <span class="btn-text">Save</span></button>
      </menu>
    </form>
  </dialog>

  <dialog id="modal-post" class="modal wide">
    <article class="post-view">
      <header>
        <h3 id="post-view-title"></h3>
        <div class="meta" id="post-view-meta"></div>
      </header>
      <section id="post-view-media"></section>
      <section id="post-view-content"></section>
      <footer class="post-view-actions">
  <a id="post-view-open" href="#" target="_blank" rel="noopener noreferrer">🔗 <span class="btn-text">Open</span> ↗</a>
  <button id="post-view-fav">☆ <span class="btn-text">Favorite</span></button>
        <input id="post-view-tag-input" type="text" placeholder="Add tag and press Enter" />
        <div id="post-view-tags" class="tag-list"></div>
      </footer>
    </article>
    <menu class="modal-actions">
  <button id="post-close-btn" value="cancel">✖ <span class="btn-text">Close</span></button>
    </menu>
  </dialog>

  <script src="feed-cycle.js?v=2025-09-23a"></script>
</body>
</html>
